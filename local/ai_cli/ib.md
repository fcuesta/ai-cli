## Staging

### Application Components

| Component                    | Tech                    | Server                               | Logs                                      | GIT                                                                                                   | Config Files (Apache, Nginx, etc)                  | Url                                                                                                                                                                                                                                           |
| --------------------------- | ----------------------- | ------------------------------------ | ----------------------------------------- | ----------------------------------------------------------------------------------------------------- | ------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **APT Next**                | Next.js (React)         | `stg-aptnext1`                       | `/var/log/nginx`                          | [git.internetbrands.com/apt/apt-next](https://git.internetbrands.com/apt/apt-next)                   | `/var/www/conf/nginx/conf.d/aptnext.conf`         | [https://staging.apartmentratings.com](https://staging.apartmentratings.com)<br>[http://stg-aptnext1.internetbrands.com:3000/](http://stg-aptnext1.internetbrands.com:3000/)<br>[http://stg-aptnext1.internetbrands.com:3001/](http://stg-aptnext1.internetbrands.com:3001/) |
| **property-manager-frontend** | React                 | `stg-satisfactsapt-web1`             | `/var/log/httpd/exchange.satisfacts.com/` | [git.internetbrands.com/apt/property-manager-frontend](https://git.internetbrands.com/apt/property-manager-frontend) | `/var/www/conf/httpd/conf.d/sfcts-apt.conf`       | [https://stg-exchange.satisfacts.com](https://exchange.satisfacts.com)                                                                                                                                                                       |
| **property-manager-services** | Spring (Java)         | `stg-aptpropertymgmt1`               | `/var/log/tomcat/propertymgmtservices.log`| [git.internetbrands.com/apt/property-manager-services](https://git.internetbrands.com/apt/property-manager-services) |                                                   | [https://stg-propertymgmt.apartmentratings.com](https://stg-propertymgmt.apartmentratings.com)<br>[https://stg-propertymgmt.apartmentratings.com/swagger-ui.html](https://stg-propertymgmt.apartmentratings.com/swagger-ui.html)             |
| **manager-center-services** | Spring (Groovy + Java)  | `stg-aptmcs1` / `stg-aptservices1`   | `/var/log/tomcat/aptservices.log`         | [git.internetbrands.com/apt/manager-center-services](https://git.internetbrands.com/apt/manager-center-services) | `/var/www/conf/tomcat/jvm.conf`                   | [https://stg-cloud-services.apartmentratings.com/](https://stg-cloud-services.apartmentratings.com/)<br>[https://stg-cloud-mcs.apartmentratings.com/](https://stg-cloud-mcs.apartmentratings.com/)<br>[http://stg-aptservices1.internetbrands.com:8080/](http://stg-aptservices1.internetbrands.com:8080/)<br>[http://stg-aptmcs1.internetbrands.com:8080/](http://stg-aptmcs1.internetbrands.com:8080/) (crons) |
| **apt-batch**               | Spring Batch (Java)     | `stg-aptbatch1`                      | `/var/log/tomcat/aptbatch.log`           | [git.internetbrands.com/apt/apt-batch](https://git.internetbrands.com/apt/apt-batch)                 | `/var/www/conf/tomcat/jvm.conf`                   | [http://stg-aptbatch1.internetbrands.com:8080](http://stg-aptbatch1.internetbrands.com:8080)                                                                                                                                                 |
| **Manager Center (Tools)**  | React                   | `stg-satisfactsapt-web1`             |                                           | [git.internetbrands.com/apt/manager-center](https://git.internetbrands.com/apt/manager-center)       |                                                   | [http://stg-mctools.apartmentratings.com/](http://stg-mctools.apartmentratings.com/)                                                                                                                                                         |
| **cloudflareuploader**      | Node.js                 | `stg-aptpropertymgmt1`               | `/var/log/httpd/cfuploader/*cronolog`     | [git.internetbrands.com/apt/cloudflareuploader](https://git.internetbrands.com/apt/cloudflareuploader) | `/var/www/node/cloudflareuploader/`               | -                                                                                                                                                                                                                                             |
| **Wordpress Blog** (ohmyapt + education) | Wordpress    | `stg-aptmisc-web1`                   |                                           |                                                                                                       |                                                   | [https://stg-ohmyapt.apartmentratings.com/wp-admin/](https://stg-ohmyapt.apartmentratings.com/wp-admin/)<br>[https://stg-education.apartmentratings.com/wp-admin/](https://stg-education.apartmentratings.com/wp-admin/)                     |
| **Varnish (?)**             |                         | `stg-aptnext1`                       | `/var/log/varnish/varnishncsa.log`        |                                                                                                       | `/etc/varnish/site.vcl`                           | [http://stg-aptnext1.internetbrands.com:80](http://stg-aptnext1.internetbrands.com:80)                                                                                                                                                       |
| **Nginx**                   |                         |                                      | `/var/log/nginx/apt-access.log`           |                                                                                                       |                                                   |                                                                                                                                                                                                       |
| **Jenkins**                 |                         | `stg-aptmaven1`                      |                                           | -                                                                                                     |                                                   | [http://stg-aptmaven1.internetbrands.com:8080/](http://stg-aptmaven1.internetbrands.com:8080/)                                                                                                                                               |

### Data Sources (Staging)

| Data Source     | Vendor  | Host                                             | Database        | Notes |
| --------------- | ------- | ------------------------------------------------ | --------------- | ----- |
| **APT-MAIN**    | MySQL   | `stg-aptratingsdb1`                              | `websimpl_aptrate` |       |
| **APT-POSTGRESS** | Postgres | `stg-aptratingspgdb1`                         | `aptratings_db` |       |
| **OHMYAPT-BLOG** | MySQL  | `stg-aptratingsdb1`                              | `civicspace`    |       |
| **SOLR**        | Solr    | `dev-apt-solr1.internetbrands.com`<br><br>**OLD solr6:**<br>`stg-aptratings-solr1.internetbrands.com` – **master (write)**<br>`stg-aptratings-solr2.internetbrands.com` – **slave**<br>`stg-aptsolr.apartmentratings.com` – **VIP** |               | [http://dev-apt-solr1.internetbrands.com:8983/solr/](http://dev-apt-solr1.internetbrands.com:8983/solr/#/)<br><br>**OLD solr6:**<br>http://stg-aptratings-solr1.internetbrands.com:8983/solr/<br>http://stg-aptsolr.apartmentratings.com/solr/<br>http://dev-aptratings-solr1.internetbrands.com:8983/solr/#/ |

---

## Production

### Application Components

| Component                    | Tech                    | Server                                                 | Logs                                      | GIT                                                                                                   | Config Files (Apache, Nginx, etc)                  | Url                                                                                                                                                                                                                                    |
| --------------------------- | ----------------------- | ------------------------------------------------------ | ----------------------------------------- | ----------------------------------------------------------------------------------------------------- | ------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **APT Next**                | Next.js (React)         | `apt-next1` / `apt-next2`                              | `/logs/nginx/apt-next1`<br>`/logs/nginx/apt-next2` | [git.internetbrands.com/apt/apt-next](https://git.internetbrands.com/apt/apt-next)                   | `/var/www/conf/nginx/conf.d/aptnext.conf`         | [https://www.apartmentratings.com/](https://www.apartmentratings.com/)<br>[http://apt-next1.internetbrands.com:3000/](http://apt-next1.internetbrands.com:3000/)<br>[http://apt-next2.internetbrands.com:3000/](http://apt-next2.internetbrands.com:3000/) |
| **property-manager-frontend** | React                 | `satisfactsapt-web1` / `satisfactsapt-web2`            | `/var/log/httpd/exchange.satisfacts.com/` | [git.internetbrands.com/apt/property-manager-frontend](https://git.internetbrands.com/apt/property-manager-frontend) | `/var/www/conf/httpd/conf.d/sfcts-apt.conf`       | [https://exchange.satisfacts.com](https://exchange.satisfacts.com)                                                                                                                                                                    |
| **property-manager-services** | Spring (Java)         | `aptpropertymgmt1` / `aptpropertymgmt2`                | `/var/log/tomcat/propertymgmtservices.log`| [git.internetbrands.com/apt/property-manager-services](https://git.internetbrands.com/apt/property-manager-services) |                                                   | [https://propertymgmt.apartmentratings.com/api/](https://propertymgmt.apartmentratings.com/api/)<br>[https://propertymgmt.apartmentratings.com/swagger-ui.html](https://propertymgmt.apartmentratings.com/swagger-ui.html)            |
| **manager-center-services** | Spring (Groovy + Java)  | `aptservices1` (**crons**)<br>`aptservices2`<br>`aptmcs1`<br>`aptmcs2` | `/var/log/tomcat/aptservices.log`         | [git.internetbrands.com/apt/manager-center-services](https://git.internetbrands.com/apt/manager-center-services) |                                                   | [https://mcs.apartmentratings.com/](https://mcs.apartmentratings.com/)                                                                                                                                                                 |
| **apt-batch**               | Spring Batch (Java)     | `aptbatch1`                                            |                                           | [git.internetbrands.com/apt/apt-batch](https://git.internetbrands.com/apt/apt-batch)                 |                                                   |                                                                                                                                                                                                |
| **Manager Center (Tools)**  | React                   | `aptmgrbxt2`                                           |                                           | [git.internetbrands.com/apt/manager-center](https://git.internetbrands.com/apt/manager-center)       |                                                   | [http://mctools.apartmentratings.com/](http://mctools.apartmentratings.com/)                                                                                                                                                          |
| **cloudflareuploader**      | Node.js                 | `aptpropertymgmt1`                                     | `/var/log/httpd/cfuploader/*cronolog`     | [git.internetbrands.com/apt/cloudflareuploader](https://git.internetbrands.com/apt/cloudflareuploader) | `/var/www/node/cloudflareuploader/`               | -                                                                                                                                                                                              |
| **Wordpress Blog** (ohmyapt + education) | Wordpress | `aptetc1` / `aptetc2`                                  |                                           |                                                                                                       |                                                   | [https://ohmyapt.apartmentratings.com/wp-admin/](https://ohmyapt.apartmentratings.com/wp-admin/)<br>[https://education.apartmentratings.com/wp-admin/](https://education.apartmentratings.com/wp-admin/)                              |
| **Varnish**                 |                         | `apt-varnish1`                                         | `/var/log/varnish/varnishncsa.log`        |                                                                                                       | `/etc/varnish/site.vcl`                           |                                                                                                                                                                                                |
| **Nginx**                   |                         | `apt-nginx1`                                           | `/var/log/nginx/apt-access.log`           |                                                                                                       |                                                   |                                                                                                                                                                                                |
| **Jenkins**                 |                         | `stg-aptmaven1` *(note: name suggests staging but listed under Prod)* |                                           |                                                                                                       |                                                   |                                                                                                                                                                                                |

### Data Sources (Production)

| Data Source     | Vendor  | Host                                              | Database        | Notes |
| --------------- | ------- | ------------------------------------------------- | --------------- | ----- |
| **APT-MAIN**    | MySQL   | `apartmentratingsdb1` / `apartmentratingsdb2`    | `websimpl_aptrate` |       |
| **APT-POSTGRESS** | Postgres | `aptratingspgdb1`                              | `aptratings_db` |       |
| **OHMYAPT-BLOG** | MySQL  | `apartmentratingsdb1`                            | `civicspace`    |       |
| **SOLR**        | Solr    | `apt-solr1.internetbrands.com` – **master (write)**<br>`aptsolr.apartmentratings.com` – **VIP**<br><br>**OLD solr6:**<br>`aptratings-solr1.internetbrands.com` – **master (write)**<br>`aptratings-solr2.internetbrands.com` – **slave**<br>`aptsolr.apartmentratings.com` – **VIP** |               | [http://apt-solr1.internetbrands.com:8983/solr/](http://apt-solr1.internetbrands.com:8983/solr/)<br>[http://aptsolr.apartmentratings.com/solr/](http://aptsolr.apartmentratings.com/solr/)<br><br>**OLD solr6:**<br>http://aptratings-solr1.internetbrands.com:8983/solr/<br>http://aptsolr.apartmentratings.com/solr/ |

---

#### Request Components Workflow (aptnext)

Cloudflare → F5 → Nginx (Prod, **NO CACHE**) → Varnish → Bauxite (Apache) → Apt-Next\[1-2] (Nginx) → Apt-Next\[1-2] (NodeJS)

Example `curl` commands:

```bash
curl -I -X GET -H 'Host: www.apartmentratings.com' 'https://www.apartmentratings.com'
curl -I -X GET -H 'Host: www.apartmentratings.com' 'http://apt-nginx1.internetbrands.com'
curl -I -X GET -H 'Host: www.apartmentratings.com' 'http://apt-varnish1.internetbrands.com:8909'
curl -I -X GET -H 'Host: www.apartmentratings.com' 'http://apt-next1.internetbrands.com'
